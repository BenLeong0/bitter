(this.webpackJsonpbitter=this.webpackJsonpbitter||[]).push([[0],{38:function(e,t,n){},48:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(25),a=n.n(r),i=(n(48),n(2)),o=n(5),u=n(7),l=n(0),j=function(){return document.title="Admin / Bitter",Object(l.jsx)("div",{children:"Admin page"})},d=n(3),b=n.n(d),p=n(8),f=n(39),h=n(4),O=n(17),m=new O.d({UserPoolId:"eu-west-2_QLAkrTR47",ClientId:"4m544sn8a7kf2023cq5qs4polc"}),x=Object(c.createContext)(void 0),g=function(e){var t=e.isLoggedIn,n=e.setIsLoggedIn,s=e.myHandle,r=e.setMyHandle,a=e.children,o="https://7z39hjjfg1.execute-api.eu-west-2.amazonaws.com/dev",u=Object(c.useState)(""),j=Object(i.a)(u,2),d=j[0],g=j[1],v=Object(c.useState)(!1),y=Object(i.a)(v,2),w=y[0],N=y[1],k=Object(c.useState)(!1),S=Object(i.a)(k,2),C=S[0],E=S[1],F=Object(c.useState)(!0),_=Object(i.a)(F,2),P=_[0],I=_[1];Object(c.useEffect)((function(){L().then((function(e){"admin"===e["custom:role"]&&N(!0),n(!0),r(e.user.username)})).catch((function(e){r(""),N(!1)}))}),[]);var L=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=m.getCurrentUser();n?n.getSession(function(){var c=Object(h.a)(b.a.mark((function c(s,r){var a,i;return b.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!s){c.next=4;break}t(),c.next=10;break;case 4:if(!r){c.next=10;break}return c.next=7,new Promise((function(e,t){n.getUserAttributes((function(n,c){if(n)t(n);else if(c){var s,r={},a=Object(f.a)(c);try{for(a.s();!(s=a.n()).done;){var i=s.value,o=i.Name,u=i.Value;r[o]=u}}catch(n){a.e(n)}finally{a.f()}e(r)}}))}));case 7:a=c.sent,i=r.getIdToken().getJwtToken(),e(Object(p.a)(Object(p.a)({user:n,headers:{Authorization:i,"x-api-key":a["custom:apikey"]}},r),a));case 10:case"end":return c.stop()}}),c)})));return function(e,t){return c.apply(this,arguments)}}()):t("Not logged in")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L().then(function(){var e=Object(h.a)(b.a.mark((function e(n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n.headers,fetch("".concat(o,"/users/follow?handle=").concat(t),{headers:c,method:"POST"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error("Follow error:",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L().then(function(){var e=Object(h.a)(b.a.mark((function e(n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n.headers,fetch("".concat(o,"/users/follow?handle=").concat(t),{headers:c,method:"DELETE"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error("Unfollow error:",e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(h.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,c){var s=new O.b({Username:t,Pool:m}),r=new O.a({Username:t,Password:n});s.authenticateUser(r,{onSuccess:function(t){console.log("onSuccess:",t),e(t)},onFailure:function(e){console.error("onFailure:",e),c(e)},newPasswordRequired:function(t){console.log("newPasswordRequired:",t),e(t)}})}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/users/exists?email=").concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return c=e.sent,console.log(c),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsx)(x.Provider,{value:{API_URL:o,authenticate:D,isEmailUsed:R,getSession:L,logout:function(){var e=m.getCurrentUser();e&&(e.signOut(),r(""),n(!1),N(!1))},refreshList:P,setRefreshList:I,refreshBitList:function(){I(!P)},isLoggedIn:t,setIsLoggedIn:n,isFollowing:C,setIsFollowing:E,currHandle:d,setCurrHandle:g,isAdmin:w,setIsAdmin:N,myHandle:s,setMyHandle:r,createFollowEdge:A,deleteFollowEdge:H},children:a})},v=(n(56),n(40)),y=(n(57),function(e){var t=e.title,n=e.logo,c=e.link;return Object(l.jsx)("div",{className:"option",children:Object(l.jsxs)(o.b,{to:c,children:[Object(l.jsx)("div",{className:"option-logo-box",children:Object(l.jsx)("img",{src:n,alt:"logo",className:"option-logo"})}),Object(l.jsx)("div",{className:"option-title",children:t})]})})}),w=function(){var e=Object(c.useContext)(x).myHandle;return Object(l.jsxs)("div",{className:"options-userbox",children:["Logged in as: ",Object(l.jsxs)(o.b,{to:"/u/".concat(e),children:["@",e]})]})},N=n.p+"static/media/home.671555e9.svg",k=n.p+"static/media/user.279444fa.svg",S=n.p+"static/media/settings.949b2aef.svg",C=n.p+"static/media/login.58b554af.svg",E=n.p+"static/media/register.2c6615d2.svg",F=function(){var e=Object(c.useContext)(x).isLoggedIn,t=function e(t,n,c){Object(v.a)(this,e),this.title=void 0,this.link=void 0,this.logo=void 0,this.title=t,this.link=n,this.logo=c},n=new t("Home","/home",N),s=new t("My Page","/me",k),r=new t("Settings","/settings",S),a=new t("Login","/login",C),i=new t("Register","/register",E);return Object(l.jsxs)("div",{className:"options-box",children:[Object(l.jsx)(y,Object(p.a)({},n)),e?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(y,Object(p.a)({},s)),Object(l.jsx)(y,Object(p.a)({},r)),Object(l.jsx)("hr",{}),Object(l.jsx)(w,{})]}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(y,Object(p.a)({},a)),Object(l.jsx)(y,Object(p.a)({},i))]})]})},_=(n(62),function(){return Object(l.jsx)("div",{className:"app-title-box",children:Object(l.jsx)(o.b,{to:"/home",children:Object(l.jsx)("div",{className:"app-title",children:"Bitter"})})})}),P=function(){return Object(l.jsxs)("div",{id:"left-col",className:"main-col",children:[Object(l.jsx)(_,{}),Object(l.jsx)(F,{})]})},I=(n(63),function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)([!1,"50%"]),a=Object(i.a)(r,2),o=a[0],j=a[1],d=Object(u.g)(),p=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),d.push("/u/".concat(n)),s("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("form",{children:[Object(l.jsxs)("span",{className:"textbox",children:["@",Object(l.jsx)("input",{type:"text",name:"url",id:"find-user-input-field",value:n,placeholder:"handle",onChange:function(e){var t=e.target.value;s(t),0===t.length?j([!1,"50%"]):j([!0,"100%"])}})]}),Object(l.jsx)("button",{type:"submit",className:"button-primary",onClick:p,disabled:!o[0],style:{opacity:o[1]},children:"Search"})]})}),L=function(){return Object(l.jsxs)("div",{className:"find-user",children:[Object(l.jsx)("div",{className:"find-user-title",children:"Go to user's page:"}),Object(l.jsx)(I,{})]})},A=(n(64),function(e){var t=e.setIsFollowingSuggested,n=e.handle,s=Object(c.useContext)(x),r=s.currHandle,a=s.setIsFollowing,i=s.createFollowEdge,o=s.isLoggedIn,u=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o?(t(!0),n===r&&a(!0),i(n)):console.log("Not logged in!");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)("button",{className:"button",onClick:u,children:"Follow"})}),H=function(e){var t=e.setIsFollowingSuggested,n=e.handle,s=Object(c.useContext)(x),r=s.myHandle,a=s.currHandle,i=s.setIsFollowing,o=s.deleteFollowEdge,u=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!==n){e.next=3;break}return console.log("Can't unfollow yourself!"),e.abrupt("return");case 3:t(!1),n===a&&i(!1),o(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)("button",{className:"button-primary",onClick:u,children:"Following"})},D=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),s=n[0],r=n[1],a=e.handle,o=e.className,u=Object(c.useContext)(x),j=u.currHandle,d=u.isFollowing;return Object(c.useEffect)((function(){e.isFollowing&&r(e.isFollowing)}),[e.isFollowing]),Object(c.useEffect)((function(){a===j&&r(d)}),[d]),Object(l.jsx)("div",{className:o,children:s?Object(l.jsx)(H,{handle:a,setIsFollowingSuggested:r}):Object(l.jsx)(A,{handle:a,setIsFollowingSuggested:r})})},R=function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){r("https://bitter-imgs.s3.eu-west-2.amazonaws.com/pfp-"+e.handle+"?".concat(Date.now()))}),[e.handle]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("hr",{className:"solid"}),Object(l.jsxs)("div",{className:"user-suggestion",children:[Object(l.jsxs)(o.b,{to:"/u/"+e.handle,children:[Object(l.jsx)("div",{className:"user-suggestion-pfp",children:Object(l.jsx)("img",{src:s,onError:function(){r("".concat("/bitter","/placeholder48.png"))},alt:"profile pic"})}),Object(l.jsxs)("div",{className:"user-suggestion-info",children:[Object(l.jsx)("div",{className:"user-suggestion-displayname",children:e.display_name}),Object(l.jsxs)("div",{className:"user-suggestion-handle",children:["@",e.handle]})]})]}),Object(l.jsx)(D,{className:"user-suggestion-follow",handle:e.handle,isFollowing:e.isFollowing})]})]})},T=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useContext)(x),d=j.API_URL,f=j.myHandle,O=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,fetch("".concat(d,"/users/suggested?myHandle=").concat(f));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,s(n),u(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){O()}),[f]),Object(l.jsxs)("div",{className:"user-suggestions",children:[Object(l.jsx)("div",{className:"user-suggestions-title",children:"Suggested users"}),o?Object(l.jsx)("div",{className:"user-suggestions-loader",children:Object(l.jsx)("div",{className:"loader"})}):Object(l.jsxs)(l.Fragment,{children:[n.map((function(e){return Object(c.createElement)(R,Object(p.a)(Object(p.a)({},e),{},{key:e.handle}))})),Object(l.jsx)("div",{className:"user-suggestions-reroller",children:Object(l.jsx)("button",{onClick:O,children:" Reroll "})})]})]})},U=function(){return Object(l.jsxs)("div",{id:"right-col",className:"main-col",children:[Object(l.jsx)(L,{}),Object(l.jsx)(T,{})]})},z=function(){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"nopage-code",children:"404"}),Object(l.jsx)("div",{className:"nopage-msg",children:"Page not found"})]})},B=n(19),J=function(){var e=Object(c.useContext)(x),t=e.API_URL,n=e.getSession,s=e.refreshBitList,r=Object(c.useState)(""),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(140),d=Object(i.a)(j,2),p=d[0],f=d[1],O=Object(c.useState)("black"),m=Object(i.a)(O,2),g=m[0],v=m[1],y=Object(c.useState)([!1,"50%"]),w=Object(i.a)(y,2),N=w[0],k=w[1],S=Object(c.useState)(!1),C=Object(i.a)(S,2),E=C[0],F=C[1],_=Object(c.useState)(!1),P=Object(i.a)(_,2),I=P[0],L=P[1],A=function(){k([!0,"100%"])},H=function(){k([!1,"50%"])};Object(c.useEffect)((function(){return f(140-o.length),void(o.length>140?(H(),v("red")):o.length>110?(A(),v("orange")):0===o.length?(H(),v("black")):(A(),v("black")))}),[o]);var D=function(){var e=Object(h.a)(b.a.mark((function e(c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.preventDefault(),n().then(function(){var e=Object(h.a)(b.a.mark((function e(n){var c,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.headers,!(p<0||p>=140)){e.next=4;break}return console.error("Invalid post length."),e.abrupt("return");case 4:return L(!0),F(!1),c["Content-Type"]="application/json",r={headers:c,method:"POST",body:JSON.stringify({content:o})},e.next=10,fetch("".concat(t,"/bits"),r).then((function(e){return e.text()})).then((function(e){"postSuccess"===JSON.parse(e).code?u(""):F(!0)})).catch((function(e){console.log("Error:",e),F(!0)})).finally((function(){L(!1),s()}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsx)("div",{className:"postbox-input",children:I?Object(l.jsx)("div",{id:"postbox-loader-wrapper",children:Object(l.jsx)("div",{className:"loader"})}):Object(l.jsxs)("form",{children:[Object(l.jsx)(B.a,{className:"bit-content",id:"postbox-input-field",placeholder:"Post a bit!",value:o,onChange:function(e){var t=e.target.value;u(t)}}),Object(l.jsx)("button",{type:"submit",className:"button-primary",onClick:D,disabled:!N[0],style:{opacity:N[1]},children:"Post"}),Object(l.jsxs)("div",{id:"postbox-charcount",style:{color:g},children:["Remaining characters: ",p]}),E?Object(l.jsx)("div",{id:"postbox-error",children:"An error occurred."}):""]})})},M=(n(65),function(){var e=Object(c.useContext)(x),t=e.isLoggedIn,n=e.myHandle,s=Object(c.useState)(""),r=Object(i.a)(s,2),a=r[0],u=r[1];return Object(c.useEffect)((function(){u("https://bitter-imgs.s3.eu-west-2.amazonaws.com/pfp-"+n+"?".concat(Date.now()))}),[n]),Object(l.jsx)("div",{className:"postbox",children:t?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"postbox-pfp",children:Object(l.jsx)("img",{src:a,onError:function(){u("".concat("/bitter","/placeholder48.png"))},alt:"pfp"})}),Object(l.jsx)(J,{})]}):Object(l.jsxs)("div",{id:"postbox-login",children:[Object(l.jsx)(o.b,{to:"/login",children:"Login"})," or ",Object(l.jsx)(o.b,{to:"/register",children:"register"})," ","to post bits"]})})}),Y=n(27),Z=n.p+"static/media/reply.34834fc8.svg",q=n.p+"static/media/replied.f6426c61.svg",V=n.p+"static/media/rebit.e12d3005.svg",G=n.p+"static/media/rebited.756a8af7.svg",$=n.p+"static/media/like.231952c6.svg",Q=n.p+"static/media/liked.bf753584.svg",K=n.p+"static/media/dislike.6101c61e.svg",W=n.p+"static/media/disliked.e954b579.svg",X=function(e){var t=e.toggleReplying,n=e.replying,s=Object(Y.a)(e,["toggleReplying","replying"]),r=Object(c.useState)(0),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(0),d=Object(i.a)(j,2),p=d[0],f=d[1],O=Object(c.useState)(0),m=Object(i.a)(O,2),g=m[0],v=m[1],y=Object(c.useContext)(x),w=y.API_URL,N=y.getSession,k=y.isLoggedIn,S=Object(c.useState)("undefined"!==typeof s.isReposted&&s.isReposted),C=Object(i.a)(S,2),E=C[0],F=C[1],_=Object(c.useState)(!1),P=Object(i.a)(_,2),I=P[0],L=P[1],A=Object(c.useState)("undefined"!==typeof s.isDisliked&&s.isDisliked),H=Object(i.a)(A,2),D=H[0],R=H[1];Object(c.useEffect)((function(){F("undefined"!==typeof s.isReposted&&s.isReposted),L("undefined"!==typeof s.isLiked&&s.isLiked),R("undefined"!==typeof s.isDisliked&&s.isDisliked)}),[s.isReposted,s.isLiked,s.isDisliked]);var T=function(){t(),console.log("reply to tweet ".concat(s.post_id)),console.error("CHANGE REPLY ICON COLOUR"),console.log(JSON.stringify(s))},U=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:F(!0),u(o+1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/rebit?post_id=").concat(s.post_id),{headers:n,method:"POST"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:L(!0),f(p+1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/like?post_id=").concat(s.post_id),{headers:n,method:"POST"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:L(!1),f(p-1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/like?post_id=").concat(s.post_id),{headers:n,method:"DELETE"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:R(!0),v(g+1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/dislike?post_id=").concat(s.post_id),{headers:n,method:"POST"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:R(!1),v(g-1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/dislike?post_id=").concat(s.post_id),{headers:n,method:"DELETE"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"bit-buttons",children:[Object(l.jsxs)("div",{className:"bit-stat",children:[n?Object(l.jsx)("img",{src:q,alt:"reply button",onClick:T}):Object(l.jsx)("img",{src:Z,alt:"reply button",onClick:T}),Object(l.jsx)("div",{className:"bit-stat-count",children:s.replies})]}),Object(l.jsxs)("div",{className:"bit-stat",children:[E?Object(l.jsx)("img",{src:G,alt:"rebit button",onClick:function(){k&&(F(!1),u(o-1),N().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.headers,fetch("".concat(w,"/bits/rebit?post_id=").concat(s.post_id),{headers:n,method:"DELETE"}).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}}):Object(l.jsx)("img",{src:V,alt:"rebit button",onClick:U}),Object(l.jsx)("div",{className:"bit-stat-count",children:s.reposts+o})]}),Object(l.jsxs)("div",{className:"bit-stat",children:[I?Object(l.jsx)("img",{src:Q,alt:"liked button",onClick:B}):Object(l.jsx)("img",{src:$,alt:"like button",onClick:z}),Object(l.jsx)("div",{className:"bit-stat-count",children:s.likes+p})]}),Object(l.jsxs)("div",{className:"bit-stat",children:[D?Object(l.jsx)("img",{src:W,alt:"disliked button",onClick:M}):Object(l.jsx)("img",{src:K,alt:"dislike button",onClick:J}),Object(l.jsx)("div",{className:"bit-stat-count",children:s.dislikes+g})]})]})};function ee(e){var t,n,s=Object(c.useRef)(null);return t=s,e.isPopoverOpen,n=e.setIsPopoverOpen,Object(c.useEffect)((function(){function e(e){t.current&&!t.current.contains(e.target)&&n(!1)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[t]),Object(l.jsx)("div",{ref:s,children:e.children})}var te=function(e){var t=e.tag;if(!/[a-zA-Z0-9]/.test(t[0]))return Object(l.jsxs)(l.Fragment,{children:["@",t]});for(var n=1;n<t.length&&/[a-zA-Z0-9]/.test(t[n]);)n++;var c=t.slice(0,n),s=t.slice(n);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(o.b,{to:"/u/".concat(c),style:{color:"#3498db"},children:["@",c]}),s]})},ne=n.p+"static/media/delete.932bd998.svg",ce=function(e){var t=e.post_id,n=e.setReplying,s=Object(c.useContext)(x),r=s.getSession,a=s.API_URL,o=Object(c.useState)(""),u=Object(i.a)(o,2),j=u[0],d=u[1],p=Object(c.useState)(140),f=Object(i.a)(p,2),O=f[0],m=f[1],g=Object(c.useState)("black"),v=Object(i.a)(g,2),y=v[0],w=v[1],N=Object(c.useState)([!1,"50%"]),k=Object(i.a)(N,2),S=k[0],C=k[1],E=Object(c.useState)(!1),F=Object(i.a)(E,2),_=F[0],P=F[1],I=Object(c.useState)(!1),L=Object(i.a)(I,2),A=L[0],H=L[1],D=function(){return C([!0,"100%"])},R=function(){return C([!1,"50%"])},T=function(){var e=Object(h.a)(b.a.mark((function e(c){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.preventDefault(),c.preventDefault(),r().then(function(){var e=Object(h.a)(b.a.mark((function e(c){var s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.headers,!(O<0||O>=140)){e.next=4;break}return console.error("Invalid post length."),e.abrupt("return");case 4:return H(!0),P(!1),s["Content-Type"]="application/json",r={headers:s,method:"POST",body:JSON.stringify({content:j,replyTo:t})},e.next=10,fetch("".concat(a,"/bits"),r).then((function(e){return e.text()})).then((function(e){"postSuccess"===JSON.parse(e).code?(d(""),n(!1)):P(!0)})).catch((function(e){console.log("Error:",e),P(!0)})).finally((function(){H(!1)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){return m(140-j.length),void(j.length>140?(R(),w("red")):j.length>110?(D(),w("orange")):0===j.length?(R(),w("black")):(D(),w("black")))}),[j]),Object(l.jsx)("div",{className:"bit-reply-box",children:A?Object(l.jsx)("div",{id:"bit-reply-loader-wrapper",children:Object(l.jsx)("div",{className:"loader"})}):Object(l.jsxs)("form",{children:[Object(l.jsx)(B.a,{id:"postbox-input-field",placeholder:"Post a reply!",value:j,onChange:function(e){var t=e.target.value;d(t)}}),Object(l.jsx)("button",{type:"submit",className:"button-primary",onClick:T,disabled:!S[0],style:{opacity:S[1]},children:"Post reply"}),Object(l.jsxs)("div",{id:"postbox-charcount",style:{color:y},children:["Remaining characters: ",O]}),_?Object(l.jsx)("div",{id:"postbox-error",children:"An error occurred."}):""]})})};function se(e){var t=new Date(e),n=Date.now()-t.getTime(),c=Math.floor(n/1e3),s=Math.floor((c%=31536e3)/86400);if(s){if(s>30){var r=String(t.getDate());return["Jan ","Feb ","Mar ","Apr ","May ","Jun ","Jul ","Aug ","Sep ","Oct ","Nov ","Dec "][t.getMonth()]+r+(t.getFullYear()===(new Date).getFullYear()?"":", bitTime.getFullYear()")}return s+"d"}var a=Math.floor((c%=86400)/3600);if(a)return a+"h";var i=Math.floor((c%=3600)/60);if(i)return i+"m";var o=c%60;return o?o+"s":"less than a second"}function re(e){var t=e.getHours(),n=e.getMinutes(),c=t>=12?"pm":"am",s=(t=(t%=12)||12)+":"+(n=n<10?"0"+n:n)+" "+c;return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+s}var ae,ie,oe,ue,le,je=function(e){var t=e.classes,n=void 0===t?"":t,s=Object(Y.a)(e,["classes"]),r=Object(c.useContext)(x),a=r.API_URL,u=r.getSession,j=r.isAdmin,d=r.myHandle,f=Object(c.useState)(""),O=Object(i.a)(f,2),m=O[0],g=O[1];Object(c.useEffect)((function(){g("https://bitter-imgs.s3.eu-west-2.amazonaws.com/pfp-"+s.handle+"?".concat(Date.now()))}),[s.handle]);var v=s.content.split("@"),y=v[0],w=d===s.handle,N=Object(c.useState)(!1),k=Object(i.a)(N,2),S=k[0],C=k[1],E=Object(c.useState)(!1),F=Object(i.a)(E,2),_=F[0],P=F[1];"undefined"===typeof s.rebitter&&null===s.reply_to||(n+=" reply-bit");var I=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),u().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.headers,c={headers:n,method:"DELETE"},e.next=4,fetch("".concat(a,"/bits?post_id=").concat(s.post_id),c).then((function(e){return e.text()})).then((function(e){"deleteSuccess"===JSON.parse(e).code?C(!0):console.log(e)})).catch((function(e){console.log("Error:",e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=Object(c.useState)(!1),A=Object(i.a)(L,2),H=A[0],D=A[1];return Object(l.jsxs)("div",{className:"bit "+n,style:{display:S?"none":""},children:[Object(l.jsxs)("div",{className:"bit-message",children:[Object(l.jsxs)("div",{className:"bit-reply-author",style:{display:null===s.reply_to?"none":"",top:"undefined"===typeof s.rebitter?"4px":"20px"},children:[Object(l.jsx)("img",{src:q,alt:"rebit button"}),Object(l.jsx)(o.b,{to:"/b/".concat(s.reply_to),children:Object(l.jsx)("span",{style:{color:"#10b"},children:"Reply"})})," ","to",Object(l.jsxs)(o.b,{to:"/u/".concat(s.reply_author),children:[" ","@",s.reply_author]}),Object(l.jsxs)("span",{style:{display:"undefined"===typeof s.rebitter?"none":"",color:"black"},children:[" ","\u30fb"," "]})]}),Object(l.jsxs)("div",{className:"bit-rebitter",style:{display:"undefined"===typeof s.rebitter?"none":""},children:[Object(l.jsx)("img",{src:G,alt:"rebit button"}),Object(l.jsx)("span",{children:"Rebitted by "}),Object(l.jsxs)(o.b,{to:"/u/".concat(s.rebitter),children:["@",s.rebitter]})]})]}),Object(l.jsx)(o.b,{to:"/u/".concat(s.handle),children:Object(l.jsx)("div",{className:"bit-pfp",children:Object(l.jsx)("img",{src:m,onError:function(){g("".concat("/bitter","/placeholder48.png"))},alt:"profile pic"})})}),Object(l.jsxs)("div",{className:"bit-content",children:[Object(l.jsxs)("div",{className:"bit-info",children:[Object(l.jsxs)(o.b,{to:"/u/".concat(s.handle),children:[Object(l.jsx)("span",{className:"bit-info-displayname",children:s.display_name}),Object(l.jsxs)("span",{className:"bit-info-handle",children:["@",s.handle]})]}),"\u30fb",Object(l.jsx)(o.b,{to:"/b/".concat(s.post_id),children:Object(l.jsx)("span",{className:"bit-info-time",title:re(new Date(s.post_time)),children:se(s.post_time)})})]}),Object(l.jsx)("input",{type:"image",className:"bit-delete",src:ne,alt:"dislike button",onClick:function(){return D(!0)},style:{display:w||j?"block":"none"}}),Object(l.jsx)(ee,{isPopoverOpen:H,setIsPopoverOpen:D,children:Object(l.jsxs)("div",{className:"bit-delete-popover",style:{display:H?"block":"none"},children:[Object(l.jsx)("button",{className:"button-primary delete-post",onClick:I,children:"Delete post"}),Object(l.jsx)("div",{className:"delete-post-arrow"})]})}),Object(l.jsxs)("div",{className:"bit-text",children:[y,v.slice(1).map((function(e,t){return Object(l.jsx)(te,{tag:e},t)}))]}),Object(l.jsx)(X,Object(p.a)(Object(p.a)({},s),{},{toggleReplying:function(){return P(!_)},replying:_}))]}),_?Object(l.jsx)(ce,{post_id:s.post_id,setReplying:P}):"",Object(l.jsx)("hr",{className:"bit-splitter"})]})},de=(n(66),function(e){var t=e.bits,n=e.isLoading;return Object(l.jsx)(l.Fragment,{children:n?Object(l.jsx)("div",{className:"bitlist-loader",children:Object(l.jsx)("div",{className:"loader"})}):t.length>0?t.map((function(e,t){return Object(c.createElement)(je,Object(p.a)(Object(p.a)({},e),{},{key:e.post_id+e.rebitter,index:t}))})):Object(l.jsx)("div",{className:"no-bits",children:"No bits found"})})}),be=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(0),d=Object(i.a)(j,2),p=d[0],f=d[1],O=Object(c.useContext)(x),m=O.API_URL,g=O.myHandle,v=O.refreshList;Object(c.useEffect)((function(){y()}),[g,v]);var y=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(p+1),t=p,u(!0),console.log("Fetching bits..."),e.next=6,fetch("".concat(m,"/bits/timeline?handle=").concat(g));case 6:return n=e.sent,e.next=9,n.json();case 9:c=e.sent,t===p&&(s(c),u(!1));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(de,{bits:n,isLoading:o})},pe=(n(67),function(){return document.title="Home / Bitter",Object(l.jsxs)("div",{className:"timeline",children:[Object(l.jsx)(M,{}),Object(l.jsx)(be,{})]})}),fe=(n(68),n(69),function(e){var t=e.handle,n=Object(c.useState)(""),s=Object(i.a)(n,2),r=s[0],a=s[1];return Object(c.useEffect)((function(){a("https://bitter-imgs.s3.eu-west-2.amazonaws.com/banner-"+t+"?".concat(Date.now()))}),[t]),Object(l.jsx)("div",{className:"user-banner",children:Object(l.jsx)("img",{src:r,onError:function(){a("".concat("/bitter","/placeholderbanner.png"))},alt:"profile banner"})})}),he=function(e){var t=e.handle,n=Object(c.useState)(""),s=Object(i.a)(n,2),r=s[0],a=s[1];return Object(c.useEffect)((function(){a("https://bitter-imgs.s3.eu-west-2.amazonaws.com/pfp-".concat(t,"?").concat(Date.now()))}),[t]),Object(l.jsx)("div",{className:"user-photo",children:Object(l.jsx)("img",{src:r,onError:function(){a("".concat("/bitter","/placeholderpfp.png"))},alt:"profile pic"})})},Oe=function(e){var t=e.handle,n=Object(c.useContext)(x),s=n.setIsFollowing,r=n.createFollowEdge,a=n.isLoggedIn,i=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a?(s(!0),r(t)):console.log("Not logged in");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)("button",{className:"button",onClick:i,children:"Follow"})},me=function(e){var t=e.handle,n=Object(c.useContext)(x),s=n.myHandle,r=n.setIsFollowing,a=n.deleteFollowEdge,i=function(){var e=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s!==t){e.next=3;break}return console.log("Can't unfollow yourself!"),e.abrupt("return");case 3:r(!1),a(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)("button",{className:"button-primary",onClick:i,children:"Following"})},xe=n(14),ge=n(15),ve=n(16),ye=Object(ve.a)(ge.a)(ae||(ae=Object(xe.a)(["\n  &-content {\n    width: 350px;\n    padding: 40px;\n    text-align: center;\n  }\n"]))),we=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),s=n[0],r=n[1],a=function(){ie&&o.go(0),r(!1),be()},o=Object(u.g)(),j=Object(c.useState)(""),d=Object(i.a)(j,2),p=d[0],f=d[1],O=Object(c.useState)(""),m=Object(i.a)(O,2),g=m[0],v=m[1],y=Object(c.useState)(!1),w=Object(i.a)(y,2),N=w[0],k=w[1],S=Object(c.useState)(!1),C=Object(i.a)(S,2),E=C[0],F=C[1],_=Object(c.useState)(!1),P=Object(i.a)(_,2),I=P[0],L=P[1],A=Object(c.useState)(!1),H=Object(i.a)(A,2),D=H[0],R=H[1],T=Object(c.useState)(!1),U=Object(i.a)(T,2),z=U[0],J=U[1],M=Object(c.useState)(!1),Y=Object(i.a)(M,2),Z=Y[0],q=Y[1],V=Object(c.useState)(void 0),G=Object(i.a)(V,2),$=G[0],Q=G[1],K=Object(c.useState)(void 0),W=Object(i.a)(K,2),X=W[0],ee=W[1],te=Object(c.useState)(!1),ne=Object(i.a)(te,2),ce=ne[0],se=ne[1],re=Object(c.useState)(!1),ae=Object(i.a)(re,2),ie=ae[0],oe=ae[1],ue=ce&&p.trim().length>0&&p.trim().length<=25&&g.trim().length<=160,le=Object(c.useContext)(x),je=le.getSession,de=le.API_URL,be=function(){e.display_name&&f(e.display_name),e.bio&&v(e.bio),se(!1),Q(void 0),ee(void 0),J(!1),q(!1)};Object(c.useEffect)((function(){be()}),[e]);var pe=function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){return t(c.result)},c.onerror=function(e){return n(e)}}))},fe=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),v(g.trim()),f(p.trim()),je().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.headers,k(!0),n["Content-Type"]="application/json",c={headers:n,method:"PATCH",body:JSON.stringify({display_name:p,bio:g})},e.next=6,fetch("".concat(de,"/users"),c).then((function(e){return e.text()})).then((function(e){"updateSuccess"===JSON.parse(e).code?oe(!0):F(!0)}));case 6:k(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],Q(n),J(n.size>20971520);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,pe($);case 3:if("string"===typeof(n=e.sent)){e.next=6;break}return e.abrupt("return");case 6:je().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.headers,k(!0),c["Content-Type"]="application/json",s={headers:c,method:"PUT",body:JSON.stringify({image:n,field:"pfp",type:$.type})},e.next=6,fetch("".concat(de,"/users"),s).then((function(e){return e.text()})).then((function(e){"uploadSuccess"===JSON.parse(e).code?(oe(!0),Q(void 0)):L(!0)}));case 6:k(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],ee(n),q(n.size>20971520);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,pe(X);case 3:if("string"===typeof(n=e.sent)){e.next=6;break}return e.abrupt("return");case 6:je().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.headers,k(!0),c["Content-Type"]="application/json",s={headers:c,method:"PUT",body:JSON.stringify({image:n,field:"banner",type:X.type})},e.next=6,fetch("".concat(de,"/users"),s).then((function(e){return e.text()})).then((function(e){"uploadSuccess"===JSON.parse(e).code?(oe(!0),ee(void 0)):R(!0)}));case 6:k(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{className:"button",onClick:function(){return r(!0)},style:{width:"140px"},children:"Edit Profile"}),Object(l.jsx)(ye,{open:s,modal:!0,onClose:a,children:N?Object(l.jsx)("div",{className:"loader"}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"edit-profile-title",children:"Edit Profile"}),Object(l.jsxs)("form",{onSubmit:fe,children:[Object(l.jsx)("div",{className:"edit-profile-label",children:"Change display name"}),Object(l.jsx)(B.a,{className:"edit-profile-input",placeholder:"Display name",value:p,onChange:function(e){var t=e.target.value;f(t),se(!0)}}),0===p.trim().length?Object(l.jsx)("div",{className:"form-error-message",children:"Display name cannot be empty"}):"",p.trim().length>25?Object(l.jsx)("div",{className:"form-error-message",children:"Display name is too long"}):"",Object(l.jsx)("div",{className:"edit-profile-label",children:"Change bio"}),Object(l.jsx)(B.a,{className:"edit-profile-input",placeholder:"Bio",value:g,onChange:function(e){var t=e.target.value;v(t),se(!0)}}),g.trim().length>160?Object(l.jsx)("div",{className:"form-error-message",children:"Bio too long"}):"",E?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred"}):"",Object(l.jsx)("button",{type:"submit",className:"button-primary edit-profile-button",style:{opacity:ue?1:.5},disabled:!ue,children:"Submit changes"})]}),Object(l.jsx)("hr",{className:"edit-profile-hr"}),Object(l.jsx)("div",{className:"edit-profile-label",children:"Change profile picture"}),Object(l.jsx)("input",{type:"file",name:"upload-pfp",accept:".jpeg, .png, .jpg",id:"upload-pfp",onChange:he}),Object(l.jsx)("div",{className:"image-rec-size",children:"(Recommended size: 140x140)"}),Object(l.jsx)("button",{className:"button-primary edit-profile-button",style:{opacity:void 0===$||z?.5:1},disabled:void 0===$||z,onClick:Oe,children:"Upload new profile pic"}),z?Object(l.jsx)("div",{className:"form-error-message",children:"File too big (max 20MB)"}):"",I?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred"}):"",Object(l.jsx)("hr",{className:"edit-profile-hr"}),Object(l.jsx)("div",{className:"edit-profile-label",children:"Change banner"}),Object(l.jsx)("input",{type:"file",name:"upload-banner",accept:".jpeg, .png, .jpg",id:"upload-banner",onChange:me}),Object(l.jsx)("div",{className:"image-rec-size",children:"(Recommended size: 600x150)"}),Object(l.jsx)("button",{className:"button-primary edit-profile-button",style:{opacity:void 0===X||Z?.5:1},disabled:void 0===X||Z,onClick:xe,children:"Upload new banner"}),Z?Object(l.jsx)("div",{className:"form-error-message",children:"File too big (max 20MB)"}):"",D?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred"}):"",Object(l.jsx)("hr",{className:"edit-profile-hr"}),Object(l.jsx)("button",{onClick:a,style:{marginTop:"20px"},children:"Close window"})]})})]})},Ne=function(e){var t=e.handle,n=e.bio,s=e.display_name,r=e.isHater,a=Object(c.useContext)(x),i=a.myHandle,o=a.isFollowing;return Object(l.jsxs)("div",{className:"user-follow-button",children:[r()?Object(l.jsx)("div",{className:"user-branding user-branding-hater",title:"This user has more dislikes than likes",children:"HATER"}):"",i===t?Object(l.jsx)(we,{bio:n,display_name:s}):o?Object(l.jsx)(me,{handle:t}):Object(l.jsx)(Oe,{handle:t})]})},ke=function(e){var t=e.updatePageState,n=e.user,s=Object(c.useState)(0),r=Object(i.a)(s,2),a=r[0],o=r[1],u=["Jan ","Feb ","Mar ","Apr ","May ","Jun ","Jul ","Aug ","Sep ","Oct ","Nov ","Dec "],j=function(e){o(e),t(e)};return Object(l.jsxs)("div",{className:"user-info",children:[Object(l.jsx)("div",{className:"user-displayname",onClick:function(){console.log("yo",n)},children:n.display_name}),Object(l.jsx)("div",{id:"user-joindate",children:function(e){if(!e)return"";var t=new Date(e),n=t.getMonth(),c=t.getFullYear();return"Joined: "+u[n]+" "+c}(n.created_on)}),Object(l.jsx)("div",{className:"user-handle",children:n.handle}),Object(l.jsx)("div",{className:"user-bio",children:n.bio}),Object(l.jsxs)("div",{className:"user-tabs",children:[Object(l.jsxs)("div",{className:"user-tab-bits"+(0===a?" user-current-tab":""),onClick:function(){return j(0)},children:[Object(l.jsx)("b",{children:n.bits_count})," Bits"]}),Object(l.jsxs)("div",{className:"user-tab-replies"+(1===a?" user-current-tab":""),onClick:function(){return j(1)},children:[Object(l.jsx)("b",{children:n.replies})," Bits and replies"]}),Object(l.jsxs)("div",{className:"user-following"+(2===a?" user-current-tab":""),onClick:function(){return j(2)},children:[Object(l.jsx)("b",{children:n.following_count})," Following"]}),Object(l.jsxs)("div",{className:"user-followers"+(3===a?" user-current-tab":""),onClick:function(){return j(3)},children:[Object(l.jsx)("b",{children:n.follower_count})," Followers"]}),Object(l.jsxs)("div",{className:"user-likes"+(4===a?" user-current-tab":""),onClick:function(){return j(4)},children:[Object(l.jsx)("b",{children:n.likes})," Likes"]})]})]})},Se=function(e){var t=e.updatePageState,n=e.user;return Object(l.jsxs)("div",{className:"user-header",children:[Object(l.jsx)(fe,{handle:n.handle}),Object(l.jsxs)("div",{className:"user-pfp-follow",children:[Object(l.jsx)(he,{handle:n.handle}),Object(l.jsx)(Ne,{handle:n.handle,bio:n.bio,display_name:n.display_name,isHater:function(){return!(!n.dislikes||!n.likes)&&n.dislikes>n.likes}})]}),Object(l.jsx)(ke,{updatePageState:t,user:n})]})},Ce=(n(38),n(71),function(e){var t=e.replies,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],a=s[1],o=Object(c.useState)(!1),u=Object(i.a)(o,2),j=u[0],d=u[1],p=Object(c.useContext)(x),f=p.API_URL,O=p.currHandle,m=p.myHandle;Object(c.useEffect)((function(){g()}),[O]);var g=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,fetch("".concat(f,"/users/posts?handle=").concat(O,"&myHandle=").concat(m));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,a(n),d(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(de,{bits:t?r:r.filter((function(e){return!e.reply_to})),isLoading:j})}),Ee=function(e){var t=e.user,n=Object(c.useContext)(x).myHandle;return Object(l.jsxs)("div",{className:"user-card",children:[Object(l.jsx)(o.b,{to:"/u/".concat(t.handle),children:Object(l.jsx)("div",{className:"bit-pfp",children:Object(l.jsx)("img",{src:"".concat("/bitter","/placeholder48.png"),alt:"profile pic"})})}),Object(l.jsxs)("div",{className:"user-card-content",children:[Object(l.jsx)(o.b,{to:"/u/".concat(t.handle),children:Object(l.jsxs)("div",{className:"user-card-info",children:[Object(l.jsx)("span",{className:"bit-info-displayname",children:t.display_name}),Object(l.jsxs)("span",{className:"bit-info-handle",children:["@",t.handle]})]})}),Object(l.jsx)("div",{className:"user-card-follow",style:{display:n===t.handle?"none":""},children:Object(l.jsx)(D,{className:"user-card-follow-button",handle:t.handle,isFollowing:t.isFollowing})}),Object(l.jsx)(o.b,{to:"/u/".concat(t.handle),children:Object(l.jsx)("div",{className:"user-card-bio",children:t.bio})})]})]})},Fe=function(e){var t=e.users,n=e.isLoading;return Object(l.jsx)(l.Fragment,{children:n?Object(l.jsx)("div",{className:"userlist-loader",children:Object(l.jsx)("div",{className:"loader"})}):t.length>0?t.map((function(e){return Object(l.jsx)(Ee,{user:e},e.handle)})):Object(l.jsx)("div",{className:"no-users",children:"No users found"})})},_e=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useContext)(x),d=j.API_URL,p=j.currHandle,f=j.myHandle;Object(c.useEffect)((function(){O()}),[p]);var O=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,fetch("".concat(d,"/users/following?handle=").concat(p,"&myHandle=").concat(f));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,s(n),u(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(Fe,{users:n,isLoading:o})},Pe=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useContext)(x),d=j.API_URL,p=j.currHandle,f=j.myHandle;Object(c.useEffect)((function(){O()}),[p]);var O=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,fetch("".concat(d,"/users/followers?handle=").concat(p,"&myHandle=").concat(f));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,s(n),u(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(Fe,{users:n,isLoading:o})},Ie=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useContext)(x),d=j.API_URL,p=j.currHandle,f=j.myHandle;Object(c.useEffect)((function(){O()}),[p]);var O=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,fetch("".concat(d,"/users/posts/likes?handle=").concat(p,"&myHandle=").concat(f));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,s(n),u(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsx)(de,{bits:n,isLoading:o})},Le=(n(72),function(e){var t=e.handle;return Object(l.jsxs)("div",{className:"user-not-found",children:["User ",Object(l.jsxs)("span",{className:"user-not-found-handle",children:["@",t]})," could not be found."]})}),Ae=function(){var e=Object(c.useState)({handle:""}),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],j=a[1],d=Object(c.useState)(Object(l.jsx)(Ce,{replies:!1})),p=Object(i.a)(d,2),f=p[0],O=p[1];document.title=(n.handle?"@"+n.handle:"user")+" / Bitter";var m=Object(c.useContext)(x),g=m.API_URL,v=m.currHandle,y=m.setCurrHandle,w=m.myHandle,N=m.setIsFollowing,k=Object(u.h)().pathname.slice(3),S=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),E(0),e.next=4,fetch("".concat(g,"/users?handle=").concat(t,"&myHandle=").concat(w),{method:"GET"});case 4:return n=e.sent,e.next=7,n.json();case 7:c=e.sent,s(c),y(c.handle),c.isFollowing&&N(c.isFollowing),j(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){S(k)}),[w]);var C=Object(u.g)();function E(e){0===e?O(Object(l.jsx)(Ce,{replies:!1})):1===e?O(Object(l.jsx)(Ce,{replies:!0})):2===e?O(Object(l.jsx)(_e,{})):3===e?O(Object(l.jsx)(Pe,{})):4===e&&O(Object(l.jsx)(Ie,{}))}return Object(c.useEffect)((function(){return C.listen((function(e){S(e.pathname.slice(3))}))}),[]),Object(l.jsx)(l.Fragment,{children:o?Object(l.jsx)("div",{className:"user-loader",children:Object(l.jsx)("div",{className:"loader"})}):Object(l.jsx)("div",{className:"user-page",children:""!==v?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(Se,{updatePageState:E,user:n}),f]}):Object(l.jsx)(Le,{handle:k})})})},He=(n(73),function(){return Object(l.jsx)("div",{className:"user-not-found",children:"Post could not be found."})}),De=function(e){var t=e.bit;return"undefined"===typeof t.pre_thread?Object(l.jsx)(l.Fragment,{}):Object(l.jsx)("div",{className:"prethread",children:t.pre_thread.map((function(e){return Object(c.createElement)(je,Object(p.a)(Object(p.a)({},e),{},{classes:"prethread-bit",key:e.post_id}))}))})},Re=(n(74),function(e){var t=e.thread;return Object(l.jsx)("div",{className:"reply-thread",children:t.map((function(e){return Object(c.createElement)(je,Object(p.a)(Object(p.a)({},e),{},{classes:"reply-thread-bit",key:e.post_id}))}))})}),Te=function(){var e=Object(c.useState)({post_id:"",handle:"",post_time:"",content:"",dislikes:0,likes:0,replies:0,reposts:0}),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],j=a[1],d=Object(c.useState)(Object(u.h)().pathname.slice(3)),f=Object(i.a)(d,2),O=f[0],m=f[1];document.title=(n.handle?"@"+n.handle:"post")+" / Bitter";var g=Object(c.useContext)(x),v=g.API_URL,y=g.myHandle,w=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,c,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,fetch("".concat(v,"/bits?post_id=").concat(t,"&handle=").concat(y));case 3:return n=e.sent,e.next=6,n.json();case 6:c=e.sent,s(c),j(!1),(r=document.getElementsByClassName("thread-main-bit")[0])&&r.scrollIntoView();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){w(O)}),[O,y]);var N=Object(u.g)();return Object(c.useEffect)((function(){return N.listen((function(e){m(e.pathname.slice(3))}))}),[]),Object(l.jsx)(l.Fragment,{children:o?Object(l.jsx)("div",{className:"user-loader",children:Object(l.jsx)("div",{className:"loader"})}):Object(l.jsx)("div",{className:"bit-page",children:""!==n.post_id?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(De,{bit:n}),Object(l.jsx)(je,Object(p.a)(Object(p.a)({},n),{},{classes:"thread-main-bit"})),"undefined"===typeof n.reply_threads?Object(l.jsx)(l.Fragment,{}):n.reply_threads.map((function(e){return Object(l.jsx)(Re,{thread:e},e[0].post_id)}))]}):Object(l.jsx)(He,{})})})},Ue=(n(75),Object(ve.a)(ge.a)(ie||(ie=Object(xe.a)(["\n  &-content {\n    width: 300px;\n    padding: 40px;\n    text-align: center;\n    transform: translateY(-160px)\n  }\n"])))),ze=function(e){var t=e.onSubmit,n=e.newEmail,s=Object(c.useState)(!1),r=Object(i.a)(s,2),a=r[0],o=r[1],u=function(){return o(!1)};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{onClick:function(){n.length>0&&o(!0)},children:"Submit"}),Object(l.jsxs)(Ue,{open:a,modal:!0,onClose:u,children:[Object(l.jsxs)("div",{style:{marginBottom:"30px"},children:["Are you sure you want to change your email to ",Object(l.jsx)("b",{children:n}),"?"]}),Object(l.jsx)("button",{onClick:function(){var e=Object(h.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:u();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),type:"submit",className:"button-primary",children:"Change email"}),Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:u,style:{marginTop:"10px"},children:"Cancel"})]})]})},Be=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(!1),d=Object(i.a)(j,2),p=d[0],f=d[1],m=Object(c.useState)(!0),g=Object(i.a)(m,2),v=g[0],y=g[1],w=Object(c.useState)(!1),N=Object(i.a)(w,2),k=N[0],S=N[1],C=Object(c.useContext)(x),E=C.authenticate,F=C.getSession,_=C.isEmailUsed,P=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,_(n);case 3:if(!e.sent){e.next=6;break}return f(!0),e.abrupt("return");case 6:F().then((function(e){var t=e.user;E(t.username,o).then((function(){var e=[new O.c({Name:"email",Value:n})];t.updateAttributes(e,(function(e,t){e?console.error(e):S(!0),console.log(t)}))})).catch((function(e){switch(e.code){case"NotAuthorizedException":y(!1)}}))})).catch((function(e){return console.error(e)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"settings-field",children:[Object(l.jsx)("div",{className:"settings-header",children:"Change email"}),Object(l.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"New email:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:n,onChange:function(e){f(!1),s(e.target.value)},type:"email",className:p?"invalid":""}),p?Object(l.jsx)("div",{className:"form-error-message",children:"An account with this email already exists"}):""]})]}),Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"Password:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:o,onChange:function(e){y(!0),u(e.target.value)},type:"password",className:v?"":"invalid"}),v?"":Object(l.jsx)("div",{className:"form-error-message",children:"Incorrect password"})]})]}),Object(l.jsx)(ze,{onSubmit:P,newEmail:n})]}),k?Object(l.jsx)("div",{className:"form-success-message",children:"Success! Please check your email to see a meaningless verification code"}):"",Object(l.jsx)("hr",{})]})},Je=Object(ve.a)(ge.a)(oe||(oe=Object(xe.a)(["\n  &-content {\n    width: 300px;\n    padding: 40px;\n    text-align: center;\n    font-size: 20px;\n    transform: translateY(-160px)\n  }\n  &-content button {\n    font-size: 12px;\n    line-height: 28px;\n    height: 28px;\n  }\n"]))),Me=function(e){var t=e.onSubmit,n=Object(c.useState)(!1),s=Object(i.a)(n,2),r=s[0],a=s[1],o=function(){return a(!1)};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{onClick:function(){return a(!0)},children:"Submit"}),Object(l.jsxs)(Je,{open:r,modal:!0,onClose:o,children:[Object(l.jsx)("div",{style:{marginBottom:"30px"},children:"Are you sure you want to change your password?"}),Object(l.jsx)("button",{onClick:function(){var e=Object(h.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:o();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),type:"submit",className:"button-primary",children:"Change password"}),Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:o,style:{marginTop:"10px"},children:"Cancel"})]})]})},Ye=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),o=a[0],u=a[1],j=Object(c.useState)(""),d=Object(i.a)(j,2),p=d[0],f=d[1],O=Object(c.useState)(!0),m=Object(i.a)(O,2),g=m[0],v=m[1],y=Object(c.useState)(!1),w=Object(i.a)(y,2),N=w[0],k=w[1],S=Object(c.useState)(!0),C=Object(i.a)(S,2),E=C[0],F=C[1],_=Object(c.useState)(!1),P=Object(i.a)(_,2),I=P[0],L=P[1],A=Object(c.useContext)(x),H=A.getSession,D=A.authenticate,R=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!((c=o).length<8)&&/[a-z]/.test(c)&&/[A-Z]/.test(c)&&/[0-9]/.test(c)&&/[-=+^$*.[\]{}()?"!@#%&/\\,><':;|_~`]/.test(c)){e.next=6;break}return console.log("invalid password"),v(!1),L(!1),e.abrupt("return");case 6:if(o===p){e.next=10;break}return k(!0),L(!1),e.abrupt("return");case 10:H().then((function(e){var t=e.user;D(t.username,n).then((function(){t.changePassword(n,o,(function(e,t){e&&console.error(e),"SUCCESS"===t&&L(!0)}))})).catch((function(e){switch(e.code){case"NotAuthorizedException":F(!1);break;default:console.error(e)}L(!1)}))})).catch((function(e){console.error(e)}));case 11:case"end":return e.stop()}var c}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"settings-field",children:[Object(l.jsx)("div",{className:"settings-header",children:"Current password:"}),Object(l.jsxs)("form",{onSubmit:R,children:[Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"Password:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:n,onChange:function(e){s(e.target.value),F(!0)},type:"password",className:E?"":"invalid"}),E?"":Object(l.jsx)("div",{className:"form-error-message",children:"Incorrect password"})]})]}),Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"New password:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:o,onChange:function(e){u(e.target.value),k(!1),v(!0)},type:"password",className:!g||N?"invalid":""}),g?"":Object(l.jsx)("div",{className:"form-error-message",children:"Invalid password"})]})]}),Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"Confirm password:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:p,onChange:function(e){f(e.target.value),k(!1)},type:"password",className:N?"invalid":""}),N?Object(l.jsx)("div",{className:"form-error-message",children:"! Passwords do not match !"}):""]})]}),Object(l.jsx)(Me,{onSubmit:R}),Object(l.jsx)("div",{style:{fontSize:"16px",display:I?"":"none"},className:"form-success-message",children:"Password has been successfully changed"})]}),Object(l.jsx)("hr",{})]})},Ze=Object(ve.a)(ge.a)(ue||(ue=Object(xe.a)(["\n  &-content {\n    width: 300px;\n    padding: 40px;\n    text-align: center;\n    transform: translateY(-160px);\n    font-size: 20px;\n  }\n  &-content button {\n    font-size: 12px;\n    line-height: 28px;\n    height: 28px;\n  }\n"]))),qe=function(e){var t=e.onSubmit,n=e.active,s=Object(c.useState)(!1),r=Object(i.a)(s,2),a=r[0],o=r[1],u=function(){return o(!1)};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{onClick:function(){n&&o(!0)},className:"button-primary",style:{backgroundColor:"#d3455b",borderColor:"#d3455b",marginBottom:"10px"},children:"Delete account"}),Object(l.jsxs)(Ze,{open:a,modal:!0,onClose:u,children:[Object(l.jsx)("div",{style:{marginBottom:"30px"},children:"Are you sure you want to delete your account?"}),Object(l.jsx)("button",{onClick:function(){var e=Object(h.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:u();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),type:"submit",className:"button-primary",style:{backgroundColor:"#d3455b",borderColor:"#d3455b"},children:"Delete account"}),Object(l.jsx)("br",{}),Object(l.jsx)("button",{className:"button-primary",onClick:u,style:{marginTop:"10px"},children:"Cancel"})]})]})},Ve=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),o=a[0],j=a[1],d=Object(c.useState)(!0),p=Object(i.a)(d,2),f=p[0],O=p[1],m=Object(c.useState)(!0),g=Object(i.a)(m,2),v=g[0],y=g[1],w=Object(c.useState)(!1),N=Object(i.a)(w,2),k=N[0],S=N[1],C=Object(c.useState)(!1),E=Object(i.a)(C,2),F=E[0],_=E[1],P=Object(c.useContext)(x),I=P.authenticate,L=P.getSession,A=P.logout,H=P.API_URL,D=Object(u.g)(),R=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),_(!0),"delete-me"===o){e.next=6;break}return y(!1),_(!1),e.abrupt("return");case 6:L().then(function(){var e=Object(h.a)(b.a.mark((function e(t){var c,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.user,s=t.headers,r=t.accessToken,I(c.username,n).then(Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s["Content-Type"]="application/json",t={headers:s,method:"DELETE"},e.next=4,fetch("".concat(H,"/users?accessToken=").concat(r.jwtToken),t).then((function(e){return e.text()})).then((function(e){var t=JSON.parse(e);"deleteSuccess"===t.code?(A(),D.push("/home")):(S(!0),_(!1),console.error(t))})).catch((function(e){console.log("Error:",e),S(!0),_(!1)}));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){switch(e.code){case"NotAuthorizedException":O(!1);break;default:console.error(e),_(!1)}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),_(!1)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"settings-field",children:[F?Object(l.jsx)("div",{className:"loader"}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"settings-header",children:"Delete account"}),Object(l.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"Password:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:n,onChange:function(e){O(!0),s(e.target.value),S(!1)},type:"password",className:f?"":"invalid"}),f?"":Object(l.jsx)("div",{className:"form-error-message",children:"Incorrect password"})]})]}),Object(l.jsxs)("div",{className:"delete-account-label",children:["Type ",Object(l.jsx)("code",{children:"delete-me"})," below to confirm your decision"]}),Object(l.jsxs)("div",{className:"settings-input-field",children:[Object(l.jsx)("div",{className:"settings-input-label",children:"Confirmation:"}),Object(l.jsxs)("div",{className:"settings-input-wrapper",children:[Object(l.jsx)("input",{value:o,onChange:function(e){y(!0),j(e.target.value),S(!1)},type:"text",className:v?"":"invalid"}),v?"":Object(l.jsx)("div",{className:"form-error-message",children:"Incorrect confirmation message"})]})]}),Object(l.jsx)(qe,{onSubmit:R,active:n.length>0}),k?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred."}):""]})]}),Object(l.jsx)("hr",{})]})},Ge=Object(ve.a)(ge.a)(le||(le=Object(xe.a)(["\n&-content {\n  width: 250px;\n  padding: 40px;\n  text-align: center;\n  font-size: 18px;\n  transform: translateY(-160px)\n}\n&-content button {\n  font-size: 12px;\n  line-height: 28px;\n  height: 28px;\n}\n"]))),$e=function(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],s=t[1],r=function(){return s(!1)},a=Object(c.useContext)(x).logout,o=Object(u.g)();return Object(l.jsxs)("div",{id:"logout-button",children:[Object(l.jsx)("button",{className:"button-primary",onClick:function(){return s(!0)},children:"Logout"}),Object(l.jsxs)(Ge,{open:n,modal:!0,onClose:r,children:[Object(l.jsx)("div",{style:{marginBottom:"30px"},children:"Are you sure you want to logout?"}),Object(l.jsx)("button",{onClick:function(e){e.preventDefault(),a(),o.push("/home")},type:"submit",className:"button-primary",children:"Logout"}),Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:r,style:{marginTop:"10px"},children:"Cancel"})]})]})},Qe=(n(76),function(){return document.title="Settings / Bitter",Object(l.jsxs)("div",{className:"settings",children:[Object(l.jsx)("div",{className:"settings-title",children:"Settings"}),Object(l.jsx)(Be,{}),Object(l.jsx)(Ye,{}),Object(l.jsx)(Ve,{}),Object(l.jsx)($e,{})]})}),Ke=(n(77),function(e){var t=e.setMyHandle;document.title="Login / Bitter";var n=Object(c.useState)(""),s=Object(i.a)(n,2),r=s[0],a=s[1],u=Object(c.useState)(""),j=Object(i.a)(u,2),d=j[0],b=j[1],p=Object(c.useState)(!1),f=Object(i.a)(p,2),h=f[0],O=f[1],m=Object(c.useState)(!1),g=Object(i.a)(m,2),v=g[0],y=g[1],w=Object(c.useState)(!1),N=Object(i.a)(w,2),k=N[0],S=N[1],C=Object(c.useContext)(x),E=C.authenticate,F=C.setIsLoggedIn,_=C.setIsAdmin;return Object(l.jsxs)("div",{className:"login",children:[Object(l.jsx)("div",{className:"login-title",children:"Login"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),E(r,d).then((function(e){console.log("Logged in!"),t(e.getIdToken().payload["cognito:username"]),"admin"===e.getIdToken().payload["custom:role"]&&_(!0),F(!0)})).catch((function(e){switch(e.code){case"UserNotConfirmedException":console.error("Email not verified"),O(!0);break;case"NotAuthorizedException":console.error("Incorrect username or password"),y(!0);break;default:console.error("Failed to login!",e),S(!0)}}))},children:[Object(l.jsxs)("div",{className:"login-input-field",children:[Object(l.jsx)("div",{className:"login-input-label",children:"Email / Handle:"}),Object(l.jsx)("input",{value:r,onChange:function(e){O(!1),y(!1),a(e.target.value),S(!1)},type:"text",className:h||v?"invalid":""}),h?Object(l.jsx)("div",{className:"form-error-message",children:"You need to verify your email before logging in"}):""]}),Object(l.jsxs)("div",{className:"login-input-field",children:[Object(l.jsx)("div",{className:"login-input-label",children:"Password:"}),Object(l.jsx)("input",{value:d,onChange:function(e){y(!1),b(e.target.value),S(!1)},type:"password",className:v?"invalid":""}),v?Object(l.jsx)("div",{className:"form-error-message",children:"Incorrect username or password"}):""]}),Object(l.jsx)("button",{type:"submit",children:"Submit"}),Object(l.jsx)("div",{id:"login-register-link",children:Object(l.jsx)(o.b,{to:"/register",children:"Create an account"})}),k?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred."}):""]})]})}),We=(n(78),function(){document.title="Register / Bitter";var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),u=a[0],j=a[1],d=Object(c.useState)(""),p=Object(i.a)(d,2),f=p[0],g=p[1],v=Object(c.useState)(""),y=Object(i.a)(v,2),w=y[0],N=y[1],k=Object(c.useState)(!1),S=Object(i.a)(k,2),C=S[0],E=S[1],F=Object(c.useState)(!1),_=Object(i.a)(F,2),P=_[0],I=_[1],L=Object(c.useState)(!1),A=Object(i.a)(L,2),H=A[0],D=A[1],R=Object(c.useState)(!1),T=Object(i.a)(R,2),U=T[0],z=T[1],B=Object(c.useState)(!1),J=Object(i.a)(B,2),M=J[0],Y=J[1],Z=Object(c.useState)(!1),q=Object(i.a)(Z,2),V=q[0],G=q[1],$=Object(c.useState)(!0),Q=Object(i.a)($,2),K=Q[0],W=Q[1],X=Object(c.useState)(!0),ee=Object(i.a)(X,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(!0),se=Object(i.a)(ce,2),re=se[0],ae=se[1],ie=Object(c.useState)(!1),oe=Object(i.a)(ie,2),ue=oe[0],le=oe[1],je=Object(c.useState)(!1),de=Object(i.a)(je,2),be=de[0],pe=de[1],fe=Object(c.useContext)(x).isEmailUsed,he=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!Oe()){e.next=4;break}return console.log("Empty fields!"),e.abrupt("return");case 4:return e.next=6,fe(u);case 6:if(!e.sent){e.next=9;break}return Y(!0),e.abrupt("return");case 9:m.signUp(n,f,[new O.c({Name:"email",Value:u})],[],(function(e,t){if(e){var n=e.code;switch(console.log(e),n){case"UsernameExistsException":z(!0);break;case"InvalidPasswordException":ae(!1);break;default:console.log("an error occured"),pe(!0)}}t&&le(!0)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=!1;return n.length<1?(console.log("no handle!"),E(!0),e=!0):n.length>25?(console.log("handle too long!"),I(!0),e=!0):me(n)||(console.log("invalid handle"),W(!1),e=!0),u.length<1&&(console.log("no email!"),D(!0),e=!0),xe(f)||(console.log("invalid password"),ae(!1),e=!0),f!==w&&(G(!0),e=!0),e},me=function(e){return!(e.length<1)&&!/[^a-zA-Z0-9]/.test(e)},xe=function(e){return!(e.length<8)&&(/[a-z]/.test(e)&&/[A-Z]/.test(e)&&/[0-9]/.test(e)&&/[-=+^$*.[\]{}()?"!@#%&/\\,><':;|_~`]/.test(e))};return Object(l.jsxs)("div",{className:"register",children:[Object(l.jsx)("div",{className:"register-title",children:"Register"}),Object(l.jsxs)("form",{onSubmit:he,children:[Object(l.jsxs)("div",{className:"register-input-field",children:[Object(l.jsx)("div",{className:"register-input-label ",children:"Handle:"}),Object(l.jsx)("input",{value:n,onChange:function(e){E(!1),I(!1),W(!0),z(!1),s(e.target.value),pe(!1)},type:"text",className:C||!K||U||P?"invalid":""}),C?Object(l.jsx)("div",{className:"form-error-message",children:"Handle field is empty"}):"",P?Object(l.jsx)("div",{className:"form-error-message",children:"Handle is too long"}):"",K?"":Object(l.jsx)("div",{className:"form-error-message",children:"Invalid handle (no special characters allowed)"}),U?Object(l.jsx)("div",{className:"form-error-message",children:"An account with this handle already exists"}):""]}),Object(l.jsxs)("div",{className:"register-input-field",children:[Object(l.jsx)("div",{className:"register-input-label",children:"Email:"}),Object(l.jsx)("input",{value:u,onChange:function(e){D(!1),Y(!1),ne(!0),j(e.target.value),pe(!1)},type:"email",className:H||M?"invalid":""}),H?Object(l.jsx)("div",{className:"form-error-message",children:"Email field is empty"}):"",M?Object(l.jsx)("div",{className:"form-error-message",children:"An account with this email already exists"}):"",te?"":Object(l.jsx)("div",{className:"form-error-message",children:"Invalid email"})]}),Object(l.jsxs)("div",{className:"register-input-field",children:[Object(l.jsx)("div",{className:"register-input-label",children:"Password:"}),Object(l.jsx)("input",{value:f,onChange:function(e){G(!1),ae(!0),g(e.target.value),pe(!1)},type:"password",className:!re||V?"invalid":""}),re?"":Object(l.jsx)("div",{className:"form-error-message",children:"Password must be at least 8 characters long, and contain at least one uppercase, lowercase, number and special character."}),Object(l.jsxs)("div",{className:"register-input-field",children:[Object(l.jsx)("div",{className:"register-input-label",children:"Confirm Password:"}),Object(l.jsx)("input",{value:w,onChange:function(e){G(!1),N(e.target.value),pe(!1)},type:"password",className:!re||V?"invalid":""})]}),V&&re?Object(l.jsx)("div",{className:"form-error-message",children:"! Passwords do not match !"}):""]}),Object(l.jsx)("button",{type:"submit",children:"Submit"}),ue?Object(l.jsxs)("div",{style:{fontSize:"16px"},className:"form-success-message",children:["Success! Please verify your email before"," ",Object(l.jsx)(o.b,{style:{color:"#33c3f0"},to:"/login",children:"logging in"})]}):"",be?Object(l.jsx)("div",{className:"form-error-message",children:"An error occurred."}):"",Object(l.jsxs)("div",{id:"register-login-link",children:["Already have an account? ",Object(l.jsx)(o.b,{to:"/login",children:"Login here"})]})]})]})}),Xe=function(e){var t=e.Component,n=(e.path,Object(c.useContext)(x).isLoggedIn);return Object(l.jsx)(u.b,{render:function(){return!0===n?Object(l.jsx)(t,{}):Object(l.jsx)(u.a,{to:{pathname:"/login"}})}})},et=function(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),d=a[0],b=a[1];return Object(l.jsx)(g,{isLoggedIn:n,setIsLoggedIn:s,myHandle:d,setMyHandle:b,children:Object(l.jsx)(o.a,{basename:"/",children:Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(P,{}),Object(l.jsx)("div",{id:"mid-col",className:"main-col",children:Object(l.jsxs)(u.d,{children:[Object(l.jsx)(u.b,{path:"/login",render:function(){return!0===n?Object(l.jsx)(u.a,{to:{pathname:"/home"}}):Object(l.jsx)(Ke,{setMyHandle:b})}}),Object(l.jsx)(u.b,{path:"/register",render:function(){return!0===n?Object(l.jsx)(u.a,{to:{pathname:"/home"}}):Object(l.jsx)(We,{})}}),Object(l.jsx)(u.b,{path:"/home",exact:!0,render:function(){return Object(l.jsx)(pe,{})}}),Object(l.jsx)(u.b,{path:"/",exact:!0,render:function(){return Object(l.jsx)(u.a,{to:{pathname:"/home"}})}}),Object(l.jsx)(Xe,{path:"/admin",Component:j}),Object(l.jsx)(Xe,{path:"/settings",Component:Qe}),Object(l.jsx)(u.b,{path:"/me",render:function(){return!0===n?Object(l.jsx)(u.a,{to:{pathname:"/u/".concat(d)}}):Object(l.jsx)(u.a,{to:{pathname:"/login"}})}}),Object(l.jsx)(u.b,{path:"/u/:handle",render:function(){return Object(l.jsx)(Ae,{})}}),Object(l.jsx)(u.b,{path:"/b/:post_id",render:function(){return Object(l.jsx)(Te,{})}}),Object(l.jsx)(u.b,{component:z})]})}),Object(l.jsx)(U,{})]})})})},tt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,80)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),s(e),r(e),a(e)}))};a.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(et,{})}),document.getElementById("root")),tt()}},[[79,1,2]]]);
//# sourceMappingURL=main.c6d3036f.chunk.js.map